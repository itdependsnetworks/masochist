import {dedent} from '@masochist/common';

import {grammar, table} from '..';
import getAugmentedGrammar from '../getAugmentedGrammar';
import getItemSets from '../getItemSets';
import getParseTable from '../getParseTable';
import itemSetsToTransitionTable from '../itemSetsToTransitionTable';
import stringifyGrammar from '../stringifyGrammar';
import stringifyParseTable from '../stringifyParseTable';
import {epsilonGrammar, subsetGrammar, toyGrammar} from './grammars';

describe('getParseTable()', () => {
  it('returns a ParseTable for the toy grammar', () => {
    const itemSets = getItemSets(toyGrammar);
    const transitionTable = itemSetsToTransitionTable(itemSets, toyGrammar);
    expect(getParseTable(itemSets, transitionTable, toyGrammar)).toEqual([
      [
        {
          star: {kind: 'Shift', state: 5},
          x: {kind: 'Shift', state: 4},
        },
        {
          E: 6,
          N: 2,
          S: 1,
          V: 3,
        },
      ],
      [{$: {kind: 'Accept'}}, {}],
      [{$: {kind: 'Reduce', rule: 1}}, {}],
      [
        {
          eq: {kind: 'Shift', state: 7},
          $: {kind: 'Reduce', rule: 4},
        },
        {},
      ],
      [
        {
          eq: {kind: 'Reduce', rule: 5},
          $: {kind: 'Reduce', rule: 5},
        },
        {},
      ],
      [
        {
          star: {kind: 'Shift', state: 5},
          x: {kind: 'Shift', state: 4},
        },
        {
          E: 8,
          V: 9,
        },
      ],
      [
        {
          $: {kind: 'Reduce', rule: 3},
        },
        {},
      ],
      [
        {
          star: {kind: 'Shift', state: 5},
          x: {kind: 'Shift', state: 4},
        },
        {
          E: 10,
          V: 9,
        },
      ],
      [
        {
          eq: {kind: 'Reduce', rule: 6},
          $: {kind: 'Reduce', rule: 6},
        },
        {},
      ],
      [
        {
          eq: {kind: 'Reduce', rule: 4},
          $: {kind: 'Reduce', rule: 4},
        },
        {},
      ],
      [
        {
          $: {kind: 'Reduce', rule: 2},
        },
        {},
      ],
    ]);
  });

  it('returns a ParseTable for the subset grammar', () => {
    const itemSets = getItemSets(subsetGrammar);
    const transitionTable = itemSetsToTransitionTable(itemSets, subsetGrammar);
    expect(getParseTable(itemSets, transitionTable, subsetGrammar)).toEqual([
      [
        {
          OPENING_BRACE: {kind: 'Shift', state: 7},
        },
        {
          Definition: 3,
          DefinitionList: 2,
          Document: 1,
          ExecutableDefinition: 4,
          OperationDefinition: 5,
          SelectionSet: 6,
        },
      ],
      [
        {
          $: {kind: 'Accept'},
        },
        {},
      ],
      [
        {
          OPENING_BRACE: {kind: 'Shift', state: 7},
          $: {kind: 'Reduce', rule: 1},
        },
        {
          Definition: 8,
          ExecutableDefinition: 4,
          OperationDefinition: 5,
          SelectionSet: 6,
        },
      ],
      [
        {
          OPENING_BRACE: {kind: 'Reduce', rule: 2},
          $: {kind: 'Reduce', rule: 2},
        },
        {},
      ],
      [
        {
          OPENING_BRACE: {kind: 'Reduce', rule: 4},
          $: {kind: 'Reduce', rule: 4},
        },
        {},
      ],
      [
        {
          OPENING_BRACE: {kind: 'Reduce', rule: 5},
          $: {kind: 'Reduce', rule: 5},
        },
        {},
      ],
      [
        {
          OPENING_BRACE: {kind: 'Reduce', rule: 6},
          $: {kind: 'Reduce', rule: 6},
        },
        {},
      ],
      [
        {
          NAME: {kind: 'Shift', state: 12},
        },
        {
          Field: 11,
          Selection: 10,
          SelectionList: 9,
        },
      ],
      [
        {
          OPENING_BRACE: {kind: 'Reduce', rule: 3},
          $: {kind: 'Reduce', rule: 3},
        },
        {},
      ],
      [
        {
          CLOSING_BRACE: {kind: 'Shift', state: 13},
          NAME: {kind: 'Shift', state: 12},
        },
        {
          Field: 11,
          Selection: 14,
        },
      ],
      [
        {
          CLOSING_BRACE: {kind: 'Reduce', rule: 8},
          NAME: {kind: 'Reduce', rule: 8},
        },
        {},
      ],
      [
        {
          CLOSING_BRACE: {kind: 'Reduce', rule: 10},
          NAME: {kind: 'Reduce', rule: 10},
        },
        {},
      ],
      [
        {
          CLOSING_BRACE: {kind: 'Reduce', rule: 11},
          NAME: {kind: 'Reduce', rule: 11},
        },
        {},
      ],
      [
        {
          OPENING_BRACE: {kind: 'Reduce', rule: 7},
          $: {kind: 'Reduce', rule: 7},
        },
        {},
      ],
      [
        {
          CLOSING_BRACE: {kind: 'Reduce', rule: 9},
          NAME: {kind: 'Reduce', rule: 9},
        },
        {},
      ],
    ]);
  });

  // Our result matches this one exactly:
  //
  //    https://cyberzhg.github.io/toolbox/lr1?grammar=UyAtPiBQcm9ncmFtClByb2dyYW0gLT4gQmFyT3B0IE9QRU4gRm9vTGlzdCBDTE9TRQpCYXJPcHQgLT4gQkFSIHwgz7UKRm9vTGlzdCAtPiBGb29MaXN0IEZPTyB8IEZPTw==
  //
  // with the exception of the "r6" action in state 0 on OPEN_BRACKET.
  //
  // In contrast:
  //
  //    http://smlweb.cpsc.ucalgary.ca/lalr1.php?grammar=S+-%3E+Program.%0AProgram+-%3E+BarOpt+open+FooList+close.%0AFooList+-%3E+FooList+foo+%7C+foo.%0ABarOpt+-%3E+bar+%7C+.&substs=
  //
  // does have that (necessary) action, although some of the state numbers
  // differ in trivial (but insignificant) ways.
  //
  it('returns a ParseTable for a grammar with epsilon productions', () => {
    const itemSets = getItemSets(epsilonGrammar);
    const transitionTable = itemSetsToTransitionTable(itemSets, epsilonGrammar);
    const parseTable = getParseTable(itemSets, transitionTable, epsilonGrammar);
    expect(stringifyParseTable(parseTable)).toBe(
      dedent`
        | State | BAR | CLOSE_BRACKET | FOO | OPEN_BRACKET |      $ |BarOpt |FooList |Program | S |
        |-------|-----|---------------|-----|--------------|--------|-------|--------|--------|---|
        |     0 |  s4 |               |     |           r6 |        |     3 |        |      2 | 1 |
        |     1 |     |               |     |              | accept |       |        |        |   |
        |     2 |     |               |     |              |     r1 |       |        |        |   |
        |     3 |     |               |     |           s5 |        |       |        |        |   |
        |     4 |     |               |     |           r5 |        |       |        |        |   |
        |     5 |     |               |  s7 |              |        |       |      6 |        |   |
        |     6 |     |            s8 |  s9 |              |        |       |        |        |   |
        |     7 |     |            r4 |  r4 |              |        |       |        |        |   |
        |     8 |     |               |     |              |     r2 |       |        |        |   |
        |     9 |     |            r3 |  r3 |              |        |       |        |        |   |
      ` + '\n',
    );

    // Just to make the above actually readable...
    expect(stringifyGrammar(getAugmentedGrammar(epsilonGrammar))).toBe(
      dedent`
        %token BAR
        %token CLOSE_BRACKET
        %token FOO
        %token OPEN_BRACKET

        r0: S' → S
        r1: S → Program
        r2: Program → BarOpt OPEN_BRACKET FooList CLOSE_BRACKET
        r3: FooList → FooList FOO
        r4: FooList → FOO
        r5: BarOpt → BAR
        r6: BarOpt → ε
      ` + '\n',
    );
  });

  it('returns a ParseTable for the full grammar', () => {
    expect('\n' + stringifyParseTable(table)).toMatchInlineSnapshot(`
      "
      | State |   AT | BANG | BLOCK_STRING_VALUE | CLOSING_BRACE | CLOSING_BRACKET | CLOSING_PAREN | COLON | DOLLAR | ELLIPSIS | EQUALS | NAME | NUMBER |  ON | OPENING_BRACE | OPENING_BRACKET | OPENING_PAREN | STRING_VALUE |      $ |Alias |Argument |ArgumentConst |ArgumentConstList |ArgumentList |ArgumentsConstOpt |ArgumentsOpt |DefaultValueOpt |Definition |DefinitionList |Directive |DirectiveConst |DirectiveConstList |DirectiveList |DirectivesConstOpt |DirectivesOpt |Document |ExecutableDefinition |Field |FragmentName |FragmentSpread |InlineFragment |ListType |ListValue |ListValueConst |ListValueConstList |ListValueList |Name |NamedType |NamedValue |NonNullType |NumberValue |ObjectField |ObjectFieldConst |ObjectFieldConstList |ObjectFieldList |ObjectValue |ObjectValueConst |OperationDefinition |OperationNameOpt |OperationType |Selection |SelectionList |SelectionSet |SelectionSetOpt |StringValue |Type |TypeConditionOpt |Value |ValueConst |Variable |VariableDefinition |VariableDefinitionList |VariableDefinitionsOpt |
      |-------|------|------|--------------------|---------------|-----------------|---------------|-------|--------|----------|--------|------|--------|-----|---------------|-----------------|---------------|--------------|--------|------|---------|--------------|------------------|-------------|------------------|-------------|----------------|-----------|---------------|----------|---------------|-------------------|--------------|-------------------|--------------|---------|---------------------|------|-------------|---------------|---------------|---------|----------|---------------|-------------------|--------------|-----|----------|-----------|------------|------------|------------|-----------------|---------------------|----------------|------------|-----------------|--------------------|-----------------|--------------|----------|--------------|-------------|----------------|------------|-----|-----------------|------|-----------|---------|-------------------|-----------------------|-----------------------|
      |     0 |      |      |                    |               |                 |               |       |        |          |        |   s7 |        |     |            s9 |                 |               |              |        |      |         |              |                  |             |                  |             |                |         3 |             2 |          |               |                   |              |                   |              |       1 |                   4 |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                  5 |                 |            6 |          |              |           8 |                |            |     |                 |      |           |         |                   |                       |                       |
      |     1 |      |      |                    |               |                 |               |       |        |          |        |      |        |     |               |                 |               |              | accept |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |     2 |      |      |                    |               |                 |               |       |        |          |        |   s7 |        |     |            s9 |                 |               |              |     r1 |      |         |              |                  |             |                  |             |                |        10 |               |          |               |                   |              |                   |              |         |                   4 |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                  5 |                 |            6 |          |              |           8 |                |            |     |                 |      |           |         |                   |                       |                       |
      |     3 |      |      |                    |               |                 |               |       |        |          |        |   r2 |        |     |            r2 |                 |               |              |     r2 |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |     4 |      |      |                    |               |                 |               |       |        |          |        |   r4 |        |     |            r4 |                 |               |              |     r4 |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |     5 |      |      |                    |               |                 |               |       |        |          |        |   r5 |        |     |            r5 |                 |               |              |     r5 |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |     6 |  r10 |      |                    |               |                 |               |       |        |          |        |  s13 |        | s14 |           r10 |                 |           r10 |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |  12 |          |           |            |            |            |                 |                     |                |            |                 |                    |              11 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |     7 |   r8 |      |                    |               |                 |               |       |        |          |        |   r8 |        |  r8 |            r8 |                 |            r8 |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |     8 |      |      |                    |               |                 |               |       |        |          |        |   r7 |        |     |            r7 |                 |               |              |     r7 |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |     9 |      |      |                    |               |                 |               |       |        |      s21 |        |  s13 |        | s14 |               |                 |               |              |        |   19 |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |   17 |             |            20 |            22 |         |          |               |                   |              |  18 |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |       16 |           15 |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    10 |      |      |                    |               |                 |               |       |        |          |        |   r3 |        |     |            r3 |                 |               |              |     r3 |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    11 |  r14 |      |                    |               |                 |               |       |        |          |        |      |        |     |           r14 |                 |           s24 |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                    23 |
      |    12 |   r9 |      |                    |               |                 |               |       |        |          |        |      |        |     |            r9 |                 |            r9 |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    13 |  r11 |  r11 |                r11 |           r11 |             r11 |           r11 |   r11 |    r11 |      r11 |    r11 |  r11 |    r11 | r11 |           r11 |             r11 |           r11 |          r11 |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    14 |  r12 |  r12 |                r12 |           r12 |             r12 |           r12 |   r12 |    r12 |      r12 |    r12 |  r12 |    r12 | r12 |           r12 |             r12 |           r12 |          r12 |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    15 |      |      |                    |           s25 |                 |               |       |        |      s21 |        |  s13 |        | s14 |               |                 |               |              |        |   19 |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |   17 |             |            20 |            22 |         |          |               |                   |              |  18 |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |       26 |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    16 |      |      |                    |           r57 |                 |               |       |        |      r57 |        |  r57 |        | r57 |               |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    17 |      |      |                    |           r59 |                 |               |       |        |      r59 |        |  r59 |        | r59 |               |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    18 |  r66 |      |                    |           r66 |                 |               |   s28 |        |      r66 |        |  r66 |        | r66 |           r66 |                 |           s29 |              |        |      |         |              |                  |             |                  |          27 |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    19 |      |      |                    |               |                 |               |       |        |          |        |  s13 |        | s14 |               |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |  30 |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    20 |      |      |                    |           r60 |                 |               |       |        |      r60 |        |  r60 |        | r60 |               |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    21 |  r98 |      |                    |               |                 |               |       |        |          |        |  s33 |        | s34 |           r98 |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |          31 |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |              32 |      |           |         |                   |                       |                       |
      |    22 |      |      |                    |           r61 |                 |               |       |        |      r61 |        |  r61 |        | r61 |               |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    23 |  s38 |      |                    |               |                 |               |       |        |          |        |      |        |     |           r45 |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |       37 |               |                   |           36 |                   |           35 |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    24 |      |      |                    |               |                 |               |       |    s42 |          |        |      |        |     |               |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |      41 |                40 |                    39 |                       |
      |    25 |      |      |                    |           r54 |                 |               |       |        |      r54 |        |  r54 |        | r54 |           r54 |                 |               |              |    r54 |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    26 |      |      |                    |           r58 |                 |               |       |        |      r58 |        |  r58 |        | r58 |               |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    27 |  s38 |      |                    |           r45 |                 |               |       |        |      r45 |        |  r45 |        | r45 |           r45 |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |       37 |               |                   |           36 |                   |           43 |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    28 |      |      |                    |               |                 |               |       |        |          |        |  r64 |        | r64 |               |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    29 |      |      |                    |               |                 |               |       |        |          |        |  s13 |        | s14 |               |                 |               |              |        |      |      45 |              |                  |          44 |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |  46 |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    30 |  r66 |      |                    |           r66 |                 |               |       |        |      r66 |        |  r66 |        | r66 |           r66 |                 |           s29 |              |        |      |         |              |                  |             |                  |          47 |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    31 |  s38 |      |                    |           r45 |                 |               |       |        |      r45 |        |  r45 |        | r45 |               |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |       37 |               |                   |           36 |                   |           48 |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    32 |  s38 |      |                    |               |                 |               |       |        |          |        |      |        |     |           r45 |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |       37 |               |                   |           36 |                   |           49 |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    33 |  r94 |      |                    |           r94 |                 |               |       |        |      r94 |        |  r94 |        | r94 |               |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    34 |      |      |                    |               |                 |               |       |        |          |        |  s13 |        | s14 |               |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |  51 |       50 |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    35 |      |      |                    |               |                 |               |       |        |          |        |      |        |     |            s9 |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |          52 |                |            |     |                 |      |           |         |                   |                       |                       |
      |    36 |  s38 |      |                    |           r44 |                 |               |       |        |      r44 |        |  r44 |        | r44 |           r44 |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |       53 |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    37 |  r46 |      |                    |           r46 |                 |               |       |        |      r46 |        |  r46 |        | r46 |           r46 |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    38 |      |      |                    |               |                 |               |       |        |          |        |  s13 |        | s14 |               |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |  54 |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    39 |      |      |                    |               |                 |           s55 |       |    s42 |          |        |      |        |     |               |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |      41 |                56 |                       |                       |
      |    40 |      |      |                    |               |                 |           r15 |       |    r15 |          |        |      |        |     |               |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    41 |      |      |                    |               |                 |               |   s57 |        |          |        |      |        |     |               |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    42 |      |      |                    |               |                 |               |       |        |          |        |  s13 |        | s14 |               |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |  58 |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    43 |      |      |                    |           r56 |                 |               |       |        |      r56 |        |  r56 |        | r56 |            s9 |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |          60 |             59 |            |     |                 |      |           |         |                   |                       |                       |
      |    44 |      |      |                    |               |                 |           s61 |       |        |          |        |  s13 |        | s14 |               |                 |               |              |        |      |      62 |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |  46 |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    45 |      |      |                    |               |                 |           r67 |       |        |          |        |  r67 |        | r67 |               |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    46 |      |      |                    |               |                 |               |   s63 |        |          |        |      |        |     |               |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    47 |  s38 |      |                    |           r45 |                 |               |       |        |      r45 |        |  r45 |        | r45 |           r45 |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |       37 |               |                   |           36 |                   |           64 |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    48 |      |      |                    |           r95 |                 |               |       |        |      r95 |        |  r95 |        | r95 |               |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    49 |      |      |                    |               |                 |               |       |        |          |        |      |        |     |            s9 |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |          65 |                |            |     |                 |      |           |         |                   |                       |                       |
      |    50 |  r97 |      |                    |               |                 |               |       |        |          |        |      |        |     |           r97 |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    51 |  r22 |  r22 |                    |               |             r22 |           r22 |       |    r22 |          |    r22 |      |        |     |           r22 |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    52 |      |      |                    |               |                 |               |       |        |          |        |   r6 |        |     |            r6 |                 |               |              |     r6 |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    53 |  r47 |      |                    |           r47 |                 |               |       |        |      r47 |        |  r47 |        | r47 |           r47 |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    54 |  r66 |      |                    |           r66 |                 |               |       |        |      r66 |        |  r66 |        | r66 |           r66 |                 |           s29 |              |        |      |         |              |                  |             |                  |          66 |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    55 |  r13 |      |                    |               |                 |               |       |        |          |        |      |        |     |           r13 |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    56 |      |      |                    |               |                 |           r16 |       |    r16 |          |        |      |        |     |               |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    57 |      |      |                    |               |                 |               |       |        |          |        |  s13 |        | s14 |               |             s70 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |      69 |          |               |                   |              |  51 |       68 |           |         71 |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |  67 |                 |      |           |         |                   |                       |                       |
      |    58 |      |      |                r18 |           r18 |             r18 |           r18 |   r18 |    r18 |          |        |  r18 |    r18 | r18 |           r18 |             r18 |               |          r18 |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    59 |      |      |                    |           r62 |                 |               |       |        |      r62 |        |  r62 |        | r62 |               |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    60 |      |      |                    |           r55 |                 |               |       |        |      r55 |        |  r55 |        | r55 |               |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    61 |  r65 |      |                    |           r65 |                 |               |       |        |      r65 |        |  r65 |        | r65 |           r65 |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    62 |      |      |                    |               |                 |           r68 |       |        |          |        |  r68 |        | r68 |               |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    63 |      |      |                s78 |               |                 |               |       |    s42 |          |        |  s13 |    s75 | s14 |           s84 |             s82 |               |          s77 |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |       81 |               |                   |              |  80 |          |        79 |            |         74 |            |                 |                     |                |         83 |                 |                    |                 |              |          |              |             |                |         76 |     |                 |   72 |           |      73 |                   |                       |                       |
      |    64 |      |      |                    |           r56 |                 |               |       |        |      r56 |        |  r56 |        | r56 |            s9 |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |          60 |             85 |            |     |                 |      |           |         |                   |                       |                       |
      |    65 |      |      |                    |           r96 |                 |               |       |        |      r96 |        |  r96 |        | r96 |               |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    66 |  r48 |      |                    |           r48 |                 |               |       |        |      r48 |        |  r48 |        | r48 |           r48 |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    67 |  r27 |      |                    |               |                 |           r27 |       |    r27 |          |    s87 |      |        |     |               |                 |               |              |        |      |         |              |                  |             |                  |             |             86 |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    68 |  r19 |  s88 |                    |               |             r19 |           r19 |       |    r19 |          |    r19 |      |        |     |               |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    69 |  r20 |  s89 |                    |               |             r20 |           r20 |       |    r20 |          |    r20 |      |        |     |               |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    70 |      |      |                    |               |                 |               |       |        |          |        |  s13 |        | s14 |               |             s70 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |      69 |          |               |                   |              |  51 |       68 |           |         71 |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |  90 |                 |      |           |         |                   |                       |                       |
      |    71 |  r21 |      |                    |               |             r21 |           r21 |       |    r21 |          |    r21 |      |        |     |               |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    72 |      |      |                    |               |                 |           r69 |       |        |          |        |  r69 |        | r69 |               |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    73 |      |      |                r75 |           r75 |             r75 |           r75 |       |    r75 |          |        |  r75 |    r75 | r75 |           r75 |             r75 |               |          r75 |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    74 |      |      |                r76 |           r76 |             r76 |           r76 |       |    r76 |          |        |  r76 |    r76 | r76 |           r76 |             r76 |               |          r76 |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    75 |  r33 |      |                r33 |           r33 |             r33 |           r33 |       |    r33 |          |        |  r33 |    r33 | r33 |           r33 |             r33 |               |          r33 |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    76 |      |      |                r77 |           r77 |             r77 |           r77 |       |    r77 |          |        |  r77 |    r77 | r77 |           r77 |             r77 |               |          r77 |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    77 |  r81 |      |                r81 |           r81 |             r81 |           r81 |       |    r81 |          |        |  r81 |    r81 | r81 |           r81 |             r81 |               |          r81 |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    78 |  r82 |      |                r82 |           r82 |             r82 |           r82 |       |    r82 |          |        |  r82 |    r82 | r82 |           r82 |             r82 |               |          r82 |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    79 |      |      |                r78 |           r78 |             r78 |           r78 |       |    r78 |          |        |  r78 |    r78 | r78 |           r78 |             r78 |               |          r78 |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    80 |  r34 |      |                r34 |           r34 |             r34 |           r34 |       |    r34 |          |        |  r34 |    r34 | r34 |           r34 |             r34 |               |          r34 |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    81 |      |      |                r79 |           r79 |             r79 |           r79 |       |    r79 |          |        |  r79 |    r79 | r79 |           r79 |             r79 |               |          r79 |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    82 |      |      |                s78 |               |             s91 |               |       |    s42 |          |        |  s13 |    s75 | s14 |           s84 |             s82 |               |          s77 |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |       81 |               |                   |           92 |  80 |          |        79 |            |         74 |            |                 |                     |                |         83 |                 |                    |                 |              |          |              |             |                |         76 |     |                 |   93 |           |      73 |                   |                       |                       |
      |    83 |      |      |                r80 |           r80 |             r80 |           r80 |       |    r80 |          |        |  r80 |    r80 | r80 |           r80 |             r80 |               |          r80 |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    84 |      |      |                    |           s94 |                 |               |       |        |          |        |  s13 |        | s14 |               |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |  97 |          |           |            |            |         96 |                 |                     |             95 |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    85 |      |      |                    |           r63 |                 |               |       |        |      r63 |        |  r63 |        | r63 |               |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    86 | s101 |      |                    |               |                 |           r50 |       |    r50 |          |        |      |        |     |               |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |           100 |                99 |              |                98 |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    87 |      |      |                s78 |               |                 |               |       |        |          |        |  s13 |    s75 | s14 |          s109 |            s107 |               |          s77 |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |           106 |                   |              |  80 |          |       105 |            |        103 |            |                 |                     |                |            |             108 |                    |                 |              |          |              |             |                |        104 |     |                 |      |       102 |         |                   |                       |                       |
      |    88 |  r25 |      |                    |               |             r25 |           r25 |       |    r25 |          |    r25 |      |        |     |               |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    89 |  r24 |      |                    |               |             r24 |           r24 |       |    r24 |          |    r24 |      |        |     |               |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    90 |      |      |                    |               |            s110 |               |       |        |          |        |      |        |     |               |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    91 |      |      |                r83 |           r83 |             r83 |           r83 |       |    r83 |          |        |  r83 |    r83 | r83 |           r83 |             r83 |               |          r83 |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    92 |      |      |                s78 |               |            s111 |               |       |    s42 |          |        |  s13 |    s75 | s14 |           s84 |             s82 |               |          s77 |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |       81 |               |                   |              |  80 |          |        79 |            |         74 |            |                 |                     |                |         83 |                 |                    |                 |              |          |              |             |                |         76 |     |                 |  112 |           |      73 |                   |                       |                       |
      |    93 |      |      |                r85 |               |             r85 |               |       |    r85 |          |        |  r85 |    r85 | r85 |           r85 |             r85 |               |          r85 |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    94 |      |      |                r87 |           r87 |             r87 |           r87 |       |    r87 |          |        |  r87 |    r87 | r87 |           r87 |             r87 |               |          r87 |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    95 |      |      |                    |          s113 |                 |               |       |        |          |        |  s13 |        | s14 |               |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |  97 |          |           |            |            |        114 |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    96 |      |      |                    |           r89 |                 |               |       |        |          |        |  r89 |        | r89 |               |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    97 |      |      |                    |               |                 |               |  s115 |        |          |        |      |        |     |               |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    98 |      |      |                    |               |                 |           r17 |       |    r17 |          |        |      |        |     |               |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |    99 | s101 |      |                    |               |                 |           r49 |       |    r49 |          |        |      |        |     |               |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |           116 |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |   100 |  r51 |      |                    |               |                 |           r51 |       |    r51 |          |        |      |        |     |               |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |   101 |      |      |                    |               |                 |               |       |        |          |        |  s13 |        | s14 |               |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              | 117 |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |   102 |  r26 |      |                    |               |                 |           r26 |       |    r26 |          |        |      |        |     |               |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |   103 |  r28 |      |                r28 |           r28 |             r28 |           r28 |       |    r28 |          |        |  r28 |    r28 | r28 |           r28 |             r28 |               |          r28 |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |   104 |  r29 |      |                r29 |           r29 |             r29 |           r29 |       |    r29 |          |        |  r29 |    r29 | r29 |           r29 |             r29 |               |          r29 |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |   105 |  r30 |      |                r30 |           r30 |             r30 |           r30 |       |    r30 |          |        |  r30 |    r30 | r30 |           r30 |             r30 |               |          r30 |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |   106 |  r31 |      |                r31 |           r31 |             r31 |           r31 |       |    r31 |          |        |  r31 |    r31 | r31 |           r31 |             r31 |               |          r31 |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |   107 |      |      |                s78 |               |            s118 |               |       |        |          |        |  s13 |    s75 | s14 |          s109 |            s107 |               |          s77 |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |           106 |               119 |              |  80 |          |       105 |            |        103 |            |                 |                     |                |            |             108 |                    |                 |              |          |              |             |                |        104 |     |                 |      |       120 |         |                   |                       |                       |
      |   108 |  r32 |      |                r32 |           r32 |             r32 |           r32 |       |    r32 |          |        |  r32 |    r32 | r32 |           r32 |             r32 |               |          r32 |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |   109 |      |      |                    |          s121 |                 |               |       |        |          |        |  s13 |        | s14 |               |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              | 124 |          |           |            |            |            |             123 |                 122 |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |   110 |  r23 |  r23 |                    |               |             r23 |           r23 |       |    r23 |          |    r23 |      |        |     |               |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |   111 |      |      |                r84 |           r84 |             r84 |           r84 |       |    r84 |          |        |  r84 |    r84 | r84 |           r84 |             r84 |               |          r84 |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |   112 |      |      |                r86 |               |             r86 |               |       |    r86 |          |        |  r86 |    r86 | r86 |           r86 |             r86 |               |          r86 |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |   113 |      |      |                r88 |           r88 |             r88 |           r88 |       |    r88 |          |        |  r88 |    r88 | r88 |           r88 |             r88 |               |          r88 |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |   114 |      |      |                    |           r90 |                 |               |       |        |          |        |  r90 |        | r90 |               |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |   115 |      |      |                s78 |               |                 |               |       |    s42 |          |        |  s13 |    s75 | s14 |           s84 |             s82 |               |          s77 |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |       81 |               |                   |              |  80 |          |        79 |            |         74 |            |                 |                     |                |         83 |                 |                    |                 |              |          |              |             |                |         76 |     |                 |  125 |           |      73 |                   |                       |                       |
      |   116 |  r52 |      |                    |               |                 |           r52 |       |    r52 |          |        |      |        |     |               |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |   117 |  r71 |      |                    |               |                 |           r71 |       |    r71 |          |        |      |        |     |               |                 |          s127 |              |        |      |         |              |                  |             |              126 |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |   118 |  r35 |      |                r35 |           r35 |             r35 |           r35 |       |    r35 |          |        |  r35 |    r35 | r35 |           r35 |             r35 |               |          r35 |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |   119 |      |      |                s78 |               |            s128 |               |       |        |          |        |  s13 |    s75 | s14 |          s109 |            s107 |               |          s77 |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |           106 |                   |              |  80 |          |       105 |            |        103 |            |                 |                     |                |            |             108 |                    |                 |              |          |              |             |                |        104 |     |                 |      |       129 |         |                   |                       |                       |
      |   120 |      |      |                r37 |               |             r37 |               |       |        |          |        |  r37 |    r37 | r37 |           r37 |             r37 |               |          r37 |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |   121 |  r39 |      |                r39 |           r39 |             r39 |           r39 |       |    r39 |          |        |  r39 |    r39 | r39 |           r39 |             r39 |               |          r39 |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |   122 |      |      |                    |          s130 |                 |               |       |        |          |        |  s13 |        | s14 |               |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              | 124 |          |           |            |            |            |             131 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |   123 |      |      |                    |           r41 |                 |               |       |        |          |        |  r41 |        | r41 |               |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |   124 |      |      |                    |               |                 |               |  s132 |        |          |        |      |        |     |               |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |   125 |      |      |                    |           r91 |                 |               |       |        |          |        |  r91 |        | r91 |               |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |   126 |  r53 |      |                    |               |                 |           r53 |       |    r53 |          |        |      |        |     |               |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |   127 |      |      |                    |               |                 |               |       |        |          |        |  s13 |        | s14 |               |                 |               |              |        |      |         |          134 |              133 |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              | 135 |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |   128 |  r36 |      |                r36 |           r36 |             r36 |           r36 |       |    r36 |          |        |  r36 |    r36 | r36 |           r36 |             r36 |               |          r36 |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |   129 |      |      |                r38 |               |             r38 |               |       |        |          |        |  r38 |    r38 | r38 |           r38 |             r38 |               |          r38 |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |   130 |  r40 |      |                r40 |           r40 |             r40 |           r40 |       |    r40 |          |        |  r40 |    r40 | r40 |           r40 |             r40 |               |          r40 |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |   131 |      |      |                    |           r42 |                 |               |       |        |          |        |  r42 |        | r42 |               |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |   132 |      |      |                s78 |               |                 |               |       |        |          |        |  s13 |    s75 | s14 |          s109 |            s107 |               |          s77 |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |           106 |                   |              |  80 |          |       105 |            |        103 |            |                 |                     |                |            |             108 |                    |                 |              |          |              |             |                |        104 |     |                 |      |       136 |         |                   |                       |                       |
      |   133 |      |      |                    |               |                 |          s137 |       |        |          |        |  s13 |        | s14 |               |                 |               |              |        |      |         |          138 |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              | 135 |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |   134 |      |      |                    |               |                 |           r72 |       |        |          |        |  r72 |        | r72 |               |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |   135 |      |      |                    |               |                 |               |  s139 |        |          |        |      |        |     |               |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |   136 |      |      |                    |           r43 |                 |               |       |        |          |        |  r43 |        | r43 |               |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |   137 |  r70 |      |                    |               |                 |           r70 |       |    r70 |          |        |      |        |     |               |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |   138 |      |      |                    |               |                 |           r73 |       |        |          |        |  r73 |        | r73 |               |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      |   139 |      |      |                s78 |               |                 |               |       |        |          |        |  s13 |    s75 | s14 |          s109 |            s107 |               |          s77 |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |           106 |                   |              |  80 |          |       105 |            |        103 |            |                 |                     |                |            |             108 |                    |                 |              |          |              |             |                |        104 |     |                 |      |       140 |         |                   |                       |                       |
      |   140 |      |      |                    |               |                 |           r74 |       |        |          |        |  r74 |        | r74 |               |                 |               |              |        |      |         |              |                  |             |                  |             |                |           |               |          |               |                   |              |                   |              |         |                     |      |             |               |               |         |          |               |                   |              |     |          |           |            |            |            |                 |                     |                |            |                 |                    |                 |              |          |              |             |                |            |     |                 |      |           |         |                   |                       |                       |
      "
    `);

    // Just to make the above actually readable...
    expect('\n' + stringifyGrammar(getAugmentedGrammar(grammar)))
      .toMatchInlineSnapshot(`
      "
      %token AMPERSAND
      %token AT
      %token BANG
      %token BAR
      %token BLOCK_STRING_VALUE
      %token CLOSING_BRACE
      %token CLOSING_BRACKET
      %token CLOSING_PAREN
      %token COLON
      %token DOLLAR
      %token ELLIPSIS
      %token EQUALS
      %token NAME
      %token NUMBER
      %token ON
      %token OPENING_BRACE
      %token OPENING_BRACKET
      %token OPENING_PAREN
      %token STRING_VALUE

      r0: Document' → Document
      r1: Document → DefinitionList {
        $$ = {
          kind: 'DOCUMENT',
          definitions: $1,
        };
      }
      r2: DefinitionList → Definition { $$ = [$1]; }
      r3: DefinitionList → DefinitionList Definition { $1.push($2); $$ = $1; }
      r4: Definition → ExecutableDefinition { $$ = $1; }
      r5: ExecutableDefinition → OperationDefinition { $$ = $1; }
      r6: OperationDefinition → OperationType OperationNameOpt VariableDefinitionsOpt DirectivesOpt SelectionSet {
        $$ = {
          kind: 'OPERATION',
          name: $2,
          directives: $4,
          selections: $5,
          type: $1,
          variables: $3,
        };
      }
      r7: OperationDefinition → SelectionSet {
        $$ = {
          kind: 'OPERATION',
          name: null,
          directives: null,
          selections: $1,
          type: 'QUERY',
          variables: null,
        };
      }
      r8: OperationType → NAME {{
        const {contents} = $1;
        if (contents === 'query') {
          $$ = 'QUERY';
        } else if (contents === 'mutation') {
          $$ = 'MUTATION';
        } else if (contents === 'subscription') {
          $$ = 'SUBSCRIPTION';
        } else {
          throw new Error(\`Unsupported operation type: \${contents}\`);
        }
      }}
      r9: OperationNameOpt → Name { $$ = $1; }
      r10: OperationNameOpt → ε { $$ = null; }
      r11: Name → NAME { $$ = $1.contents; }
      r12: Name → ON { $$ = null; }
      r13: VariableDefinitionsOpt → OPENING_PAREN VariableDefinitionList CLOSING_PAREN {
        $$ = $2;
      }
      r14: VariableDefinitionsOpt → ε { $$ = null; }
      r15: VariableDefinitionList → VariableDefinition { $$ = [$1]; }
      r16: VariableDefinitionList → VariableDefinitionList VariableDefinition {
        $1.push($2); $$ = $1;
      }
      r17: VariableDefinition → Variable COLON Type DefaultValueOpt DirectivesConstOpt {
        $$ = {
          kind: 'VARIABLE_DEFINITION',
          defaultValue: $4,
          directives: $5,
          type: $3,
          variable: $1,
        };
      }
      r18: Variable → DOLLAR Name {
        $$ = {
          kind: 'VARIABLE',
          name: $2,
        };
      }
      r19: Type → NamedType { $$ = $1; }
      r20: Type → ListType { $$ = $1; }
      r21: Type → NonNullType { $$ = $1; }
      r22: NamedType → Name {
        $$ = {
          kind: 'NAMED_TYPE',
          name: $1,
        };
      }
      r23: ListType → OPENING_BRACKET Type CLOSING_BRACKET {
        $$ = {
          kind: 'LIST_TYPE',
          type: $2,
        };
      }
      r24: NonNullType → ListType BANG {
        $$ = {
          kind: 'NON_NULL_TYPE',
          type: $1,
        };
      }
      r25: NonNullType → NamedType BANG {
        $$ = {
          kind: 'NON_NULL_TYPE',
          type: $1,
        };
      }
      r26: DefaultValueOpt → EQUALS ValueConst { $$ = $2; }
      r27: DefaultValueOpt → ε { $$ = null; }
      r28: ValueConst → NumberValue { $$ = $1; }
      r29: ValueConst → StringValue { $$ = $1; }
      r30: ValueConst → NamedValue { $$ = $1; }
      r31: ValueConst → ListValueConst { $$ = $1; }
      r32: ValueConst → ObjectValueConst { $$ = $1; }
      r33: NumberValue → NUMBER {{
        const {contents} = $1;

        // TODO: Distinguish between these tokens in the lexer instead?
        if (/^-?\\\\d+$/.test(contents)) {
          $$ = {kind: 'INT', value: parseInt(contents, 10)};
        } else {
          $$ = {kind: 'FLOAT', value: contents};
        }
      }}
      r34: NamedValue → Name {{
        const name = $1;
        if (name === 'true') {
          $$ = {kind: 'BOOLEAN', value: true};
        } else if (name === 'false') {
          $$ = {kind: 'BOOLEAN', value: false};
        } else if (name === 'null') {
          $$ = {kind: 'NULL'};
        } else {
          $$ = {kind: 'ENUM', value: name};
        }
      }}
      r35: ListValueConst → OPENING_BRACKET CLOSING_BRACKET {
        $$ = {
          kind: 'LIST_VALUE',
          value: [],
        };
      }
      r36: ListValueConst → OPENING_BRACKET ListValueConstList CLOSING_BRACKET {
        $$ = {
          kind: 'LIST_VALUE',
          value: $2,
        };
      }
      r37: ListValueConstList → ValueConst { $$ = [$1]; }
      r38: ListValueConstList → ListValueConstList ValueConst { $1.push($2); $$ = $1; }
      r39: ObjectValueConst → OPENING_BRACE CLOSING_BRACE {
        $$  = {
          kind: 'OBJECT_VALUE',
          fields: [],
        };
      }
      r40: ObjectValueConst → OPENING_BRACE ObjectFieldConstList CLOSING_BRACE {
        $$ = {
          kind: 'OBJECT_VALUE',
          fields: $2,
        };
      }
      r41: ObjectFieldConstList → ObjectFieldConst { $$ = [$1]; }
      r42: ObjectFieldConstList → ObjectFieldConstList ObjectFieldConst { $1.push($2); $$ = $1; }
      r43: ObjectFieldConst → Name COLON ValueConst {
        $$ = {
          name: $1,
          value: $3,
        };
      }
      r44: DirectivesOpt → DirectiveList { $$ = $1; }
      r45: DirectivesOpt → ε { $$ = null; }
      r46: DirectiveList → Directive { $$ = [$1]; }
      r47: DirectiveList → DirectiveList Directive { $1.push($2); $$ = $1; }
      r48: Directive → AT Name ArgumentsOpt {
        $$ = {
          kind: 'DIRECTIVE',
          arguments: $3,
          name: $2,
        };
      }
      r49: DirectivesConstOpt → DirectiveConstList { $$ = $1; }
      r50: DirectivesConstOpt → ε { $$ = null; }
      r51: DirectiveConstList → DirectiveConst { $$ = [$1]; }
      r52: DirectiveConstList → DirectiveConstList DirectiveConst { $1.push($2); $$ = $1; }
      r53: DirectiveConst → AT Name ArgumentsConstOpt {
        $$ = {
          kind: 'DIRECTIVE',
          arguments: $3,
          name: $2,
        };
      }
      r54: SelectionSet → OPENING_BRACE SelectionList CLOSING_BRACE { $$ = $2; }
      r55: SelectionSetOpt → SelectionSet { $$ = $1; }
      r56: SelectionSetOpt → ε { $$ = null; }
      r57: SelectionList → Selection { $$ = [$1]; }
      r58: SelectionList → SelectionList Selection { $1.push($2); $$ = $1; }
      r59: Selection → Field { $$ = $1; }
      r60: Selection → FragmentSpread { $$ = $1; }
      r61: Selection → InlineFragment { $$ = $1; }
      r62: Field → Name ArgumentsOpt DirectivesOpt SelectionSetOpt {
        $$ = {
          kind: 'FIELD',
          alias: null,
          arguments: $2,
          directives: $3,
          name: $1,
          selections: $4,
        };
      }
      r63: Field → Alias Name ArgumentsOpt DirectivesOpt SelectionSetOpt {
        $$ = {
          kind: 'FIELD',
          alias: $1,
          arguments: $3,
          directives: $4,
          name: $2,
          selections: $5,
        };
      }
      r64: Alias → Name COLON { $$ = $1; }
      r65: ArgumentsOpt → OPENING_PAREN ArgumentList CLOSING_PAREN { $$ = $2; }
      r66: ArgumentsOpt → ε { $$ = null; }
      r67: ArgumentList → Argument { $$ = [$1]; }
      r68: ArgumentList → ArgumentList Argument { $1.push($2); $$ = $1; }
      r69: Argument → Name COLON Value {
        $$ = {
          kind: 'ARGUMENT',
          name: $1,
          value: $3,
        };
      }
      r70: ArgumentsConstOpt → OPENING_PAREN ArgumentConstList CLOSING_PAREN { $$ = $2; }
      r71: ArgumentsConstOpt → ε { $$ = null; }
      r72: ArgumentConstList → ArgumentConst { $$ = [$1]; }
      r73: ArgumentConstList → ArgumentConstList ArgumentConst { $1.push($2); $$ = $1; }
      r74: ArgumentConst → Name COLON ValueConst {
        $$ = {
          kind: 'ARGUMENT',
          name: $1,
          value: $3,
        };
      }
      r75: Value → Variable { $$ = $1; }
      r76: Value → NumberValue { $$ = $1; }
      r77: Value → StringValue { $$ = $1; }
      r78: Value → NamedValue { $$ = $1; }
      r79: Value → ListValue { $$ = $1; }
      r80: Value → ObjectValue { $$ = $1; }
      r81: StringValue → STRING_VALUE {
        $$ = {
          kind: 'STRING',
          block: false,
          // TODO: consider doing this slice in the lexer
          value: $1.contents.slice(1, -1),
        };
      }
      r82: StringValue → BLOCK_STRING_VALUE {
        $$ = {
          kind: 'STRING',
          block: true,
          // TODO: preprocess value here...
          value: $1.contents,
        };
      }
      r83: ListValue → OPENING_BRACKET CLOSING_BRACKET {
        $$ = {
          kind: 'LIST_VALUE',
          value: [],
        };
      }
      r84: ListValue → OPENING_BRACKET ListValueList CLOSING_BRACKET {
        $$ = {
          kind: 'LIST_VALUE',
          value: $2,
        };
      }
      r85: ListValueList → Value { $$ = [$1]; }
      r86: ListValueList → ListValueList Value { $1.push($2); $$ = $1; }
      r87: ObjectValue → OPENING_BRACE CLOSING_BRACE {
        $$  = {
          kind: 'OBJECT_VALUE',
          fields: [],
        };
      }
      r88: ObjectValue → OPENING_BRACE ObjectFieldList CLOSING_BRACE {
        $$ = {
          kind: 'OBJECT_VALUE',
          fields: $2,
        };
      }
      r89: ObjectFieldList → ObjectField { $$ = [$1]; }
      r90: ObjectFieldList → ObjectFieldList ObjectField { $1.push($2); $$ = $1; }
      r91: ObjectField → Name COLON Value {
        $$ = {
          name: $1,
          value: $3,
        };
      }
      r92: FragmentDefinition → FragmentKeyword FragmentName ON NamedType DirectivesOpt SelectionSet {
        $$ = {
          kind: 'FRAGMENT',
          directives: $5,
          name: $2,
          on: $4,
          selections: $6,
        };
      }
      r93: FragmentKeyword → NAME {
        const {contents} = $1;
        if (contents !== 'fragment') {
          throw new Error(\`Expected \\"fragment\\" keyword, got: \${contents}\`);
        }
        $$ = null;
      }
      r94: FragmentName → NAME { $$ = $1.contents; }
      r95: FragmentSpread → ELLIPSIS FragmentName DirectivesOpt {
        $$ = {
          kind: 'FRAGMENT_SPREAD',
          name: $2,
          directives: $3,
        };
      }
      r96: InlineFragment → ELLIPSIS TypeConditionOpt DirectivesOpt SelectionSet {
        $$ = {
          kind: 'INLINE_FRAGMENT',
          directives: $3,
          on: $2,
          selections: $4,
        };
      }
      r97: TypeConditionOpt → ON NamedType { $$ = $2; }
      r98: TypeConditionOpt → ε { $$ = null; }
      "
    `);
  });
});
